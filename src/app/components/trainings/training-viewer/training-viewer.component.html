<div [@trainingToggle]="isOpen ? 'open' : 'closed'">
    <div *ngIf="selectedTraining$ | async" class="training-container">
        <i class="fal fa-times"
            style="font-size: 22px;font-weight:300;color:red;position:fixed;right:10px;top:15px;cursor: pointer;"
            (click)="trainingService.changeEditorVisualState(false)"></i>
        <div *ngIf="selectedTraining.pages !== null" class="toc-container" [ngStyle]="styleMap.get('toc-container')">
            <div class="toc-title" [ngStyle]="styleMap.get('toc-title')">
                Table of Contents
            </div>
            <div class="toc-entry" *ngFor="let page of selectedTraining.pages; index as pageIndex"
                [ngClass]="{'active-toc-entry':currentPageId === page._id}" (click)="setCurrentPage(page._id)">
                <ng-container *ngFor="let page of selectedTraining.pages; index as pageIndex">
                </ng-container>
            </div>
        </div>
        <div *ngIf="(selectedTraining.pages === null)" class="main-content" [ngStyle]="styleMap.get('main-content')">
            <div  style="width:100%;height:100%;padding:20px;color:black;">
                <div [ngStyle]="styleMap.get('page')">
                    {{page.title}}
                </div>

                <div style="padding-left: 30px;">
                    <span style="font-size:18px;">
                        {{page.intro}}
                    </span>
                </div>
                <div *ngFor="let portlet of page.portlets; index as portletIndex" style="width:100%;height:100%;">

                    <div style="width:100%;height:100%;">
                        <div *ngIf="!(portlet.file === null) && fileService.getFile(portlet.file).iconType === 'image'">
                            <img [src]="fileService.getFile(portlet.file).versions[0].url" alt="blah" />
                        </div>
                        <!-- this next block uses the filestack document previewer -->
                        <div *ngIf="!(portlet.file === null)  && previewDocTypes.includes(fileService.getFile(portlet.file).iconType)"
                            style="width:100%;height:100%">
                            <iframe [src]="fileService.privateDocumentHash[portlet._id] | async" allowfullscreen
                                width="100%" height="100%">
                            </iframe>
                        </div>
                    </div>
                </div>
            </div>
            <nz-modal [(nzVisible)]="isFileSelectModalVisible" nzTitle="Select Document" (nzOnCancel)="handleCancel()"
                nzOkDisabled="true">
                <ul style="list-style-type:none;">
                    <li *ngFor="let item of files$ | async; index as i" class="fileList" (click)="selectFile(item, i)"
                        style="padding:5px 0;">
                        <div style="display: inline-block;">
                            <i *ngIf="item.iconSource === 'ngZorro'" class="font-size-24"
                                [twoToneColor]="item.iconColor" nz-icon [nzType]="item.iconClass" theme="twotone"></i>
                            <i *ngIf="item.iconSource === 'fontawesome'" class="font-size-24"
                                [ngStyle]="{'color': item.iconColor}" [ngClass]="item.iconClass"></i>
                        </div>
                        <div class="" style="display: inline-block;">
                            &nbsp;&nbsp;&nbsp;&nbsp;{{ item.name }}
                        </div>
                    </li>
                </ul>
            </nz-modal>
            <nz-modal [(nzVisible)]="isIconSelectModalVisible" nzTitle="Select Icon"
                (nzOnCancel)="handleIconSelectCancel()" nzOkDisabled="false" (nzOnOk)="handleIconSelectConfirm()">
                <mtd-icon-picker (icon)="setIcon($event)"></mtd-icon-picker>
            </nz-modal>

        </div>
    </div>
</div>
