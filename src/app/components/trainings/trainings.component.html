<div style="padding-left:20px;">
  <nz-tabset>
    <nz-tab [nzTitle]="template1">
      <ng-template #template1>
        <i class="fad fa-hat-wizard" style="color:#951eca;font-size:20px;margin-right:10px;"></i>Create/Update Trainings
      </ng-template>

      <div class="training-container">
        <div *ngIf="trainings && trainings.length > 0" style="margin-bottom:10px;">
          <button nz-button nzType="primary" nzShape="round" (click)="createNewTraining()" style="margin:0 0 20px 0;">
            Create a New Training
          </button>
        </div>
        <div style="display:block;">
          <!--
          <div *ngFor="let training of trainings " style="display:inline-block;">
            <div class="cell-item-sm" (click)="selectTraining(training._id)">
              <div style="display:block;font-size:12px;">
                <i *ngIf="training.status === 'unlocked'" nz-icon nzType="unlock" [nzTheme]="'twotone'"
                  style="display:inline-block;font-size:14px;float: left;" [nzTwotoneColor]="'#52c41a'"></i>
                <i *ngIf="training.status === 'locked'" nz-icon nzType="lock" [nzTheme]="'twotone'"
                  style="display:inline-block;font-size:14px;float: left;" [nzTwotoneColor]="'red'"></i>
                <span
                  style="display:inline-block;float:right;">{{ versionFormatter(training.versions[0].version) }}</span>
                <div style="clear:both;"> </div>
              </div>
              <div style="display:block;text-align: center;">
                <i [ngStyle]="{'color': training.iconColor}" [ngClass]="training.iconClass"
                  style="font-size:40px;padding-top:5px;"></i>
              </div>
              <div class="item-sm" style="display:block;padding-top:5px;">
                {{ training.title }}
              </div>
            </div>
          </div>
          -->
          <nz-table #nestedTable [nzData]="trainings" nzSize="small" [nzShowPagination]="false"
            style="width:100%;background-color: #fafafa;font-size:12px;display:inline-block;">
            <thead nzSingleSort>
              <tr>
                <th nzShowExpand></th>
                <th nzShowSort>State</th>
                <th nzShowSort>Title</th>
                <th nzShowSort>Category</th>
                <th nzShowSort>Subcategory</th>
                <th nzShowSort>Rating</th>
                <th>Version</th>
                <th nzShowSort>Date Created</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <ng-template ngFor let-data [ngForOf]="nestedTable.data">
                <tr style="font-size:12px;background-color: white;line-height:10px;">
                  <td nzShowExpand [(nzExpand)]="data.expand" nz-tooltip nzTooltipTitle="Show Version History"></td>
                  <td style="vertical-align: middle;">
                    <i *ngIf="data.status === 'unlocked'" nz-icon nzType="unlock" [nzTheme]="'twotone'"
                      style="display:inline-block;font-size:20px;vertical-align: middle;" nz-tooltip
                      nzTooltipTitle="This training is being edited." [nzTwotoneColor]="'#52c41a'"></i>
                    <i *ngIf="data.status === 'locked'" nz-icon nzType="lock" [nzTheme]="'twotone'"
                      style="display:inline-block;font-size:20px;vertical-align: middle;" [nzTwotoneColor]="'red'"
                      nz-tooltip nzTooltipTitle="This training is locked."></i>
                  </td>
                  <td>
                    <i [ngClass]="data.iconClass" style="font-size:22px;margin-right:10px;vertical-align: middle;"
                      [ngStyle]="{'color': data.iconColor}">
                    </i>
                    {{ data.title }}
                  </td>
                  <td>
                    {{ data.category }}
                  </td>
                  <td>
                    {{ data.subcategory }}
                  </td>
                  <td>
                    <nz-rate ngDefaultControl nzDisabled [(ngModel)]="ratingHash[data._id]" class="small"></nz-rate>
                  </td>
                  <td>{{ versionFormatter(data.versions[0].version) }}</td>
                  <td>{{ data.dateCreated | date:'mediumDate' }}</td>
                  <td>
                    <i nz-icon nzType="edit" [nzTheme]="'twotone'"
                      style="cursor:pointer;font-size:14px;vertical-align: middle;margin-right:5px;"
                      (click)="selectTraining(data._id)" nz-tooltip nzTooltipTitle="Edit Training">
                    </i>
                    <i nz-icon nzType="message" [nzTheme]="'twotone'" [nzTwotoneColor]="'orange'"
                      style="cursor:pointer;font-size:14px;vertical-align: middle;margin-right:5px;"
                      (click)="showComments(data._id)" nz-tooltip nzTooltipTitle="View Comments">
                    </i>
                    <i nz-icon nzType="delete" [nzTheme]="'twotone'" [nzTwotoneColor]="'red'"
                      style="cursor:pointer;font-size:14px;vertical-align: middle;" nz-popconfirm
                      nzPopconfirmTitle="Delete this Training?" [nzPopconfirmTrigger]="'click'"
                      [nzPopconfirmPlacement]="'top'" (nzOnConfirm)="deleteTraining(data._id)" nz-tooltip
                      nzTooltipTitle="Delete Training">
                    </i>
                  </td>
                </tr>
                <tr [nzExpand]="data.expand" style="background-color: #fffcf1;border:1px solid #e7c076">
                  <td
                    style="border-top:1px solid #e7c076;border-left:1px solid #e7c076;border-bottom:1px solid #e7c076;">
                  </td>
                  <td colspan="8"
                    style="border-top:1px solid #e7c076;border-right:1px solid #e7c076;border-bottom:1px solid #e7c076;padding-right:10px;">
                    <nz-table #innerTable [nzData]="data.versions" nzSize="small" [nzShowPagination]="false"
                      [nzTitle]="versionTableTitle"
                      style="width:100%;background-color: #f5f5f5;font-size:10px;display:inline-block;margin:10px 0;border:1px solid #cccccc;">
                      <thead>
                        <tr style="font-size:12px;">
                          <th style="font-size:12px;color:blue;">Title</th>
                          <th style="font-size:12px;color:blue;">Version</th>
                          <th style="font-size:12px;color:blue;">Change Comment</th>
                          <th style="font-size:12px;color:blue;">Date Created</th>
                        </tr>
                      </thead>
            <tbody>
              <tr *ngFor="let data of innerTable.data" (click)="data.version"
                style="cursor: pointer;font-size:12px;background-color: white;line-height:10px;">
                <td style="font-size:12px;color:#1a22a0;">
                  <i [ngClass]="data.iconClass" style="font-size:20px;margin-right:10px;vertical-align: middle;"
                    [ngStyle]="{'color': data.iconColor}">
                  </i>
                  {{ data.title }}
                </td>
                <td style="font-size:12px;color:#1a22a0;">{{ versionFormatter(data.version) }}</td>
                <td style="font-size:12px;color:#1a22a0;">{{ data.changeLog }}</td>
                <td style="font-size:12px;color:#1a22a0;">{{ data.dateCreated | date:'mediumDate' }}</td>
                <td style="font-size:12px;color:#1a22a0;"></td>
              </tr>
            </tbody>
          </nz-table>
          </td>
          </tr>
          </ng-template>
          </tbody>
          </nz-table>
          <ng-template #versionTableTitle>
            <div style="font-size:14px;text-align: center;color: blue;font-weight:500;">
              <span style="font-size:14px;text-align: center;color: blue;">Version History</span>
            </div>
          </ng-template>
        </div>
        <div *ngIf="showCommentsPanel" style="display: block;padding-top:20px;">
          <div *ngIf="currentTrainingId"
            style="display: block;padding:10px;text-align: center;border-bottom: 1px solid #e1e1e1;">
            <i [ngClass]="trainingIdHash[currentTrainingId].iconClass"
              style="font-size:24px;vertical-align:baseline;margin-right:10px;"
              [ngStyle]="{'color': trainingIdHash[currentTrainingId].iconColor}">
            </i>
            <span style="font-size:24px;">{{ trainingIdHash[currentTrainingId].title }}</span>
            <i nz-icon nzType="close-circle" [nzTheme]="'outline'" style="cursor:pointer;color:red;font-size:18px;vertical-align: baseline;float:right;padding:10px;"
            (click)="showCommentsPanel = false">
            </i>

          </div>
          <div *ngFor="let comment of commentHash[currentTrainingId]" style="padding-left:20px;">
            <div style="display: block;">
              <nz-rate nzDisabled [(ngModel)]="comment.rating" class="small" ngDefaultControl
                style="display: inline-block;margin-right:20px;"></nz-rate>
              <div style="display: inline-block;font-size:10px;">
                {{ comment.date | date:'medium' }}
              </div>
            </div>
            <div style="display: block;font-size:16px;">
              {{ comment.text }}
            </div>
            <hr style="display: block;margin:10px 0;">
          </div>
          <div *ngIf="commentHash[currentTrainingId] && commentHash[currentTrainingId].length === 0" style="padding:20px;">
            <i nz-icon nzType="frown" [nzTheme]="'twotone'"
              style="font-size:28px;vertical-align: baseline;margin-right:15px;">
            </i>
            No Comments Yet
          </div>
        </div>
        <div *ngIf="trainings && trainings.length === 0" style="text-align: center;margin-top:40px;">
          <span style="font-size:20px;font-weight: 200;display:block;">You haven't created any trainings yet!</span>
          <button nz-button nzType="primary" nzShape="round" (click)="newTraining()" style="margin-top: 20px;">
            Create a New Training
          </button>
        </div>
        <div style="padding:10px;height:90%;">
          <app-training-viewer></app-training-viewer>
        </div>
      </div>
    </nz-tab>
    <nz-tab [nzTitle]="template2">
      <ng-template #template2>
        <i class="fad fa-chart-bar" style="color:#951eca;font-size:20px;margin-right:10px;"></i>
        Analytics
      </ng-template>
      Content of Tab Pane 2
    </nz-tab>
  </nz-tabset>
</div>