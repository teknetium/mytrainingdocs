<div style="height:100%;">
    <div class="my-team" style="height:100%;">
        <div *ngIf="myTeam && myTeam.length > 0" style="height:95%;">
            <div class="team-container">
                <div class="direct-report-container">
                    <div>
                        <span style="font-size:24px;">Team Members</span>
                        <hr style="margin-bottom:10px 0;">
                    </div>
                    <div style="display:block;margin-bottom:20px;">
                        <button nz-button nzShape="round" nzSize="small" (click)="addUser()" nzType="primary"
                            style="float:left;">
                            <i nz-icon nzType="user-add" [nzTheme]="'outline'"
                                style="display:inline-block;font-size:18px;vertical-align:baseline;"></i>Add User
                        </button>
                        <button nz-button nzShape="round" (click)="launchImporter()" nzSize="small" nzType="primary"
                            style="float:right;">
                            <i nz-icon nzType="usergroup-add" [nzTheme]="'outline'"
                                style="display:inline-block;font-size:18px;vertical-align:baseline;"></i>Bulk Add
                        </button>
                        <div style="clear:both;"> </div>
                    </div>
                    <div>
                        <hr style="margin-bottom:5px;">
                        <div style="text-align: center;">
                            <span style="font-size:14px;">Filters</span>
                            <div style="display: block;margin-bottom:20px;">
                                <div style="float:left;">
                                    <div style="display:block;">
                                        <span style="font-size:12px;">Training Status</span>
                                    </div>
                                    <div style="cursor:pointer;float:left;padding:0 4px;border-radius:4px;border:1px solid #bbbbbb;margin-right:1px;"
                                        (click)="toggleFilter('up-to-date')"
                                        [ngClass]="{'showing': showUpToDate, 'not-showing': !showUpToDate}" nz-tooltip
                                        nzTooltipTitle="Users with Up To Date training status">
                                        <!--
                                        <i *ngIf="showUpToDate" class="fa fas fa-check"
                                            style="color:black;font-size:12px;"></i>
                                            -->
                                        <i class="fad fa-user" style="color:#75c140"></i>
                                    </div>
                                    <div style="cursor:pointer;float:left;padding:0 4px;border-radius:4px;border:1px solid #bbbbbb;"
                                        (click)="toggleFilter('past-due')"
                                        [ngClass]="{'showing': showPastDue, 'not-showing': !showPastDue}" nz-tooltip
                                        nzTooltipTitle="Users with Past Due training status">
                                        <!--
                                        <i *ngIf="showPastDue" class="fa fas fa-check"
                                            style="color:black;font-size:12px;"></i>
                                            -->
                                        <i class="fad fa-user" style="color:red;"></i>
                                    </div>
                                </div>
                                <div style="float:right;">
                                    <div style="display:block;">
                                        <span style="font-size:12px;">User Type</span>
                                    </div>
                                    <div style="cursor:pointer;float:left;padding:0 4px;border-radius:4px;border:1px solid #bbbbbb;margin-right:1px;"
                                        (click)="toggleFilter('individual-contributor')"
                                        [ngClass]="{'showing': showIndividualContributors, 'not-showing': !showIndividualContributors}"
                                        nz-tooltip nzTooltipTitle="Individual Contributors">
                                        <!--
                                        <i *ngIf="showIndividualContributors" class="fa fas fa-check"
                                            style="color:black;font-size:12px;"></i>
                                            -->
                                        <i class="fad fa-user" style="color:black"></i>
                                    </div>
                                    <div style="cursor:pointer;float:left;padding:0 4px;border-radius:4px;border:1px solid #bbbbbb;margin-right:1px;"
                                        (click)="toggleFilter('supervisor')"
                                        [ngClass]="{'showing': showSupervisors, 'not-showing': !showSupervisors}"
                                        nz-tooltip nzTooltipTitle="Supervisors">
                                        <!--
                                        <i *ngIf="showSupervisors" class="fa fas fa-check"
                                            style="color:black;font-size:12px;"></i>
                                            -->
                                        <i class="fad fa-user-tie" style="color:black;"></i>
                                    </div>
                                    <div style="cursor:pointer;float:left;padding:0 4px;border-radius:4px;border:1px solid #bbbbbb;margin-right:1px;"
                                        (click)="toggleFilter('volunteer')"
                                        [ngClass]="{'showing': showVolunteers, 'not-showing': !showVolunteers}"
                                        nz-tooltip nzTooltipTitle="Volunteers">
                                        <!--
                                        <i *ngIf="showVolunteers" class="fa fas fa-check" style="color:black;font-size:12px;"></i>
                                        -->
                                        <i class="fad fa-user-cowboy" style="color:black;"></i>
                                    </div>
                                    <div style="cursor:pointer;float:left;padding:0 4px;border-radius:4px;border:1px solid #bbbbbb;margin-right:1px;"
                                        (click)="toggleFilter('customer')"
                                        [ngClass]="{'showing': showCustomers, 'not-showing': !showCustomers}" nz-tooltip
                                        nzTooltipTitle="Customers">
                                        <!--
                                        <i *ngIf="showCustomers" class="fa fas fa-check" style="color:black;font-size:12px;"></i>
                                        -->
                                        <i class="fad fa-user-crown" style="color:black;"></i>
                                    </div>
                                </div>
                                <div style="clear:both;"></div>
                            </div>
                        </div>
                        <hr>
                    </div>
                    <div style="background-color: white;">
                        <!--
                        <nz-tree [nzData]="nodes" nzAsyncData (nzClick)="nzEvent($event)" (nzExpandChange)="nzEvent($event)"></nz-tree>
                        <nz-tree [nzData]="nodes" ></nz-tree>
                        -->
                        <!--
    <ng-template #nzTreeTemplate let-node let-origin="origin">
        <span>{{myTeamIdHash[node.origin.uid].firstName}}</span>
      <span class="custom-node">
        <span *ngIf="!node.isLeaf" (contextmenu)="contextMenu($event, menu)">
          <i nz-icon [nzType]="node.isExpanded ? 'folder-open' : 'folder'" (click)="openFolder(node)"></i>
          <span class="folder-name">{{ node.title }}</span>
          <span class="folder-desc">created by {{ origin.author | lowercase }}</span>
        </span>
        <span *ngIf="node.isLeaf" (contextmenu)="contextMenu($event, menu)">
          <i nz-icon nzType="file"></i>
          <span class="file-name">{{ node.title }}</span>
          <span class="file-desc">modified by {{ origin.author | lowercase }}</span>
        </span>
      </span>
    </ng-template>
    -->

                        <div *ngIf="authenticatedUser$ | async as user" class="user-button" style=""
                            (click)="selectUser(user._id)" [ngClass]="{'user-selected': userIdSelected === user._id }">
                            <i [ngClass]="userTypeIconHash[user.userType]"
                                [ngStyle]="{'color': trainingStatusColorHash[user.trainingStatus]}" nz-tooltip
                                [nzTooltipTitle]=""></i>&nbsp;
                            <span style="display:inline-block;">{{ user.firstName }} {{ user.lastName }} </span>&nbsp;
                        </div>
                        <div
                            style="cursor:pointer;display:block;margin-left:10px;width:fit-content;border-left:1px solid #bbbbbb;">
                            <div style="display:block;position:relative;top:11px;">
                                <div *ngFor="let user of myTeamFiltered" class="direct-report-cell">
                                    <div *ngIf="user._id !== (authenticatedUser$ | async)?._id" class="user-button"
                                        (click)="selectUser(user._id)"
                                        style="position:relative;top:10px;left:10px;border-left:1px solid #bbbbbb;"
                                        [ngClass]="{'user-selected': userIdSelected === user._id}">
                                        <i [ngClass]="userTypeIconHash[user.userType]"
                                            [ngStyle]="{'color': trainingStatusColorHash[user.trainingStatus]}"></i>&nbsp;
                                        <span style="display:inline-block">{{ user.firstName }} {{ user.lastName }}
                                        </span>&nbsp;
                                        <i *ngIf="user.teamAdmin === true" nz-icon nzType="crown" [nzTheme]="'twotone'"
                                            [nzTwotoneColor]="'#6939c9'"
                                            style="display:inline-block;font-size:16px;vertical-align:text-bottom;"
                                            nz-tooltip nzTooltipTitle="Admin User"></i>
                                        <i *ngIf="user.userStatus === 'pending'" nz-icon nzType="warning"
                                            [nzTheme]="'twotone'" [nzTwotoneColor]="'#efb753'"
                                            style="margin-left:2px;margin-right:2px;display:inline-block;font-size:16px;vertical-align:text-bottom;"
                                            nz-tooltip nzTooltipTitle="User Account Pending"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <div class="my-team-rightside" style="width:77%;">
                <div style="text-align: center;">
                    <span style="font-size:24px;display:inline-block;">Member Details</span>
                    <hr style="margin-bottom:10px 0;">
                </div>
                <div *ngIf="selectedUser">
                    <div class="" style="width:100%;height:44px;text-align: center;">
                        <i [ngClass]="userTypeIconHash[selectedUser.userType]" style="font-size:20px;"
                            [ngStyle]="{'color': trainingStatusColorHash[selectedUser.trainingStatus]}" nz-tooltip
                            [nzTooltipTitle]=""></i>&nbsp;
                        <span
                            style="display:inline-block;margin-left:10px;font-size:26px;font-weight: 300;">{{selectedUser.firstName}}
                            {{selectedUser.lastName}}</span>
                        &nbsp;&nbsp;&nbsp;
                        <!--
                        <i nz-icon nzType="edit" [nzTheme]="'twotone'"
                            style="cursor:pointer;font-size:16px;vertical-align: text-top;" nz-tooltip
                            nzTooltipTitle="Edit User" (click)="editUser()"></i>
                        <i nz-icon nzType="delete" [nzTheme]="'twotone'" [nzTwotoneColor]="'red'"
                            style="margin-left:10px;cursor:pointer;font-size:16px;vertical-align: text-top;" nz-tooltip
                            nzTooltipTitle="Delete User" nz-popconfirm nzPopconfirmTitle="Delete this user?"
                            (nzOnConfirm)="confirmDelete(selectedUser)"></i>
                            -->
                    </div>
                    <div style=" width:100%;">
                        <nz-modal [nzVisible]="showUserTrainingModal" nzTitle="Assign Training To User"
                            [nzCancelDisabled]="assignableTrainings.length === 0"
                            (nzOnCancel)="handleCancelUserTraining()" [nzOkDisabled]="!selectedTrainingId"
                            (nzOnOk)="handleAssignUserTraining()" style="width:500px;padding:10px;float:left;">
                            <div>
                                <div style="background-color:white;display:inline-block;width:100%;">
                                    <div *ngIf="teamTrainings.length === 0">
                                        You have not created any trainings yet!<br> Head over to the <span
                                            style="color:blue;">All
                                            Trainings</span> page to create your
                                        trainings.
                                    </div>
                                    <div *ngIf="teamTrainings.length > 0 && assignableTrainings.length === 0">
                                        You have already assigned all trainings to this user!
                                    </div>
                                    <div *ngIf="assignableTrainings.length > 0">
                                        Select the training you would like to assign to this user.
                                    </div>
                                    <div *ngFor="let training of assignableTrainings" class="all-training-list-entry"
                                        style="padding:10px 20px;width:100%;"
                                        [ngClass]="{'selected-training': selectedTrainingId === training._id}"
                                        (click)="selectedTrainingId = training._id">
                                        <i *ngIf="allTrainingIdHash[training._id].status === 'unlocked'" nz-icon
                                            nzType="unlock" [nzTheme]="'twotone'"
                                            style="margin-right:10px;display:inline-block;font-size:12px;vertical-align: middle;"
                                            [nzTwotoneColor]="'#52c41a'"></i>
                                        <i *ngIf="allTrainingIdHash[training._id].status === 'locked'" nz-icon
                                            nzType="lock" [nzTheme]="'twotone'"
                                            style="margin-right:10px;display:inline-block;font-size:12px;vertical-align: middle;"
                                            [nzTwotoneColor]="'red'"></i>

                                        <i [ngClass]="allTrainingIdHash[training._id].iconClass"
                                            style="display:inline-block;font-size:20px;margin-right:10px;vertical-align: middle;"
                                            [ngStyle]="{'color': allTrainingIdHash[training._id].iconColor}">
                                        </i>
                                        <div style="display:inline-block;font-size:14px;">
                                            {{ training.title }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </nz-modal>

                        <div style="width:100%;">
                            <button nz-button nzType="primary" nzShape="round" nzSize="small"
                                (click)="showUserTrainingModal = true" style="margin-right:10px;">
                                Assign a Training
                            </button>
                            <button nz-button nzType="primary" nzShape="round" nzSize="small" style="margin-right:10px;"
                                (click)="editUser()">
                                Edit Profile
                            </button>
                            <button nz-button nzType="primary" nzShape="round" nzSize="small" style="margin-right:10px;"
                                nz-popconfirm nzPopconfirmTitle="Delete this user?"
                                (nzOnConfirm)="confirmDelete(selectedUser)">
                                Delete User
                            </button>
                            <div style="clear:both;margin-bottom:20px;"></div>
                            <app-user-trainings mode="admin" logSession="off"></app-user-trainings>
                        </div>
                    </div>
                    <nz-drawer [nzClosable]="false" [nzMaskClosable]="true" [nzVisible]="userPanelVisible"
                        nzPlacement="right" nzTitle="User Profile" [nzWidth]="700">
                        <div style="display:block;width:100%;">
                            <div style="display:block;width:90%;">
                                <div style="display:inline-block;width:25%;text-align: right;">
                                    <label style="font-size:14px;color:black;">
                                        First Name
                                    </label>
                                </div>
                                <div style="display:inline-block;width:70%;margin-left:20px;">
                                    <input nz-input nzSize="small" type="text" placeholder="First Name" ngDefaultControl
                                        [(ngModel)]="selectedUser.firstName" style="margin-bottom:2px;">
                                </div>
                            </div>
                            <div style="display:block;width:90%;">
                                <div style="display:inline-block;width:25%;text-align: right;">
                                    <label style="font-size:14px;color:black;">
                                        Last Name
                                    </label>
                                </div>
                                <div style="display:inline-block;width:70%;margin-left:20px;">
                                    <input nz-input nzSize="small" type="text" placeholder="Last Name" ngDefaultControl
                                        [(ngModel)]="selectedUser.lastName" style="margin-bottom:2px;">
                                </div>
                            </div>
                            <div style="display:block;width:90%;">
                                <div style="display:inline-block;width:25%;text-align: right;">
                                    <label style="font-size:14px;color:black;">
                                        Email
                                    </label>
                                </div>
                                <div style="display:inline-block;width:70%;margin-left:20px;">
                                    <input nz-input nzSize="small" type="text" placeholder="Email" ngDefaultControl
                                        [(ngModel)]="selectedUser.email" style="margin-bottom:2px;">
                                </div>
                            </div>
                            <div style="display:block;width:90%;">
                                <div style="display:inline-block;width:25%;text-align: right;">
                                    <label style="font-size:14px;color:black;">
                                        Job Title
                                    </label>
                                </div>
                                <div style="display:inline-block;width:70%;margin-left:20px;">
                                    <input style="margin-bottom:2px;" placeholder="Job Title" nz-input
                                        [(ngModel)]="selectedUser.jobTitle" ngDefaultControl nzSize="small"
                                        (ngModelChange)="onJobTitleChange($event)" [nzAutocomplete]="auto"
                                        (keydown.enter)="setJobTitle($event)" (blur)="setJobTitle($event)" />
                                    <nz-autocomplete [nzDataSource]="matchingJobTitles" #auto></nz-autocomplete>
                                </div>
                            </div>
                            <div style="display:block;width:90%;">
                                <div style="display:inline-block;width:25%;text-align: right;">
                                    <label style="font-size:14px;color:black;">
                                        Supervisor
                                    </label>
                                </div>
                                <div style="display:inline-block;width:70%;margin-left:20px;">
                                    <!--
    <nz-select nzShowSearch nzAllowClear nzPlaceHolder="Select a person" [(ngModel)]="myTeam">
        <nz-option *ngFor="let user of newUsers" [nzLabel]="user.firstName + ' ' + user.lastName" [nzValue]="user."></nz-option>
        <nz-option nzLabel="Lucy" nzValue="lucy"></nz-option>
        <nz-option nzLabel="Tom" nzValue="tom"></nz-option>
    </nz-select>                                    
    -->
                                    <input nz-input nzSize="small" type="text" placeholder="Supervisor" ngDefaultControl
                                        [(ngModel)]="selectedUser.email" style="margin-bottom:2px;">
                                </div>
                            </div>
                            <div style="display:block;margin-top:10px;width:90%;">
                                <div style="float:left;width:25%;text-align: right;">
                                    <label>
                                        User Type
                                    </label>
                                </div>
                                <div style="display:inline-block;width:70%;margin-left:20px;">
                                    <nz-radio-group ngDefaultControl [(ngModel)]="selectedUser.userType"
                                        style="margin-bottom:20px;">
                                        <label nz-radio nzValue="individualContributor"
                                            (click)="newSupervisorSelected(false)"
                                            style="display:block;font-size:20px;">
                                            <i class="fad fa-user" style="vertical-align: bottom;"></i>
                                            <span style="margin-left:10px;font-size:12px;">Individual
                                                Contributor</span>
                                        </label>
                                        <label nz-radio nzValue="supervisor" (click)="newSupervisorSelected(true)"
                                            style="display:block;font-size:20px;">
                                            <i class="fad fa-user-tie" style="vertical-align: bottom;"></i>
                                            <span style="margin-left:10px;font-size:12px;">Supervisor</span>
                                        </label>
                                        <label nz-radio nzValue="volunteer" (click)="newSupervisorSelected(false)"
                                            style="display:block;font-size:20px;">
                                            <i class="fad fa-user-cowboy" style="vertical-align: bottom;"></i>
                                            <span style="margin-left:10px;font-size:12px;">Volunteer</span>
                                        </label>
                                        <label nz-radio nzValue="customer" (click)="newSupervisorSelected(false)"
                                            style="display:block;font-size:20px;">
                                            <i class="fad fa-user-crown" style="vertical-align: bottom;"></i>
                                            <span style="margin-left:10px;  font-size:12px;">Customer</span>
                                        </label>
                                    </nz-radio-group>
                                </div>
                            </div>
                            <div style="display:block;margin-top:10px;width:90%;">
                                <div style="display:inline-block;width:25%;text-align: right;">
                                </div>
                                <div style="display:inline-block;width:70%;margin-left:20px;">
                                    <label nz-checkbox ngDefaultControl [(ngModel)]="selectedUser.teamAdmin"
                                        style="margin-top:5px;font-size:12px;" nz-tooltip
                                        nzTooltipTitle="Give this person the ability to create, update, delete trainings.">Training
                                        Admin
                                        Access</label>
                                </div>
                            </div>

                            <hr>

                            <div style="display:block;margin-top:20px;width:90%;text-align: center;">
                                <div style="display:inline-block;width:60%;">
                                    <button nz-button nzSize="small" nzShape="round" (click)="handleCancel()"
                                        nzType="default" style="margin: 10px;display:inline-block;">Cancel
                                    </button>
                                    <button *ngIf="newUser" nz-button nzSize="small" nzShape="round"
                                        (click)="handleAddUser()" nzType="primary"
                                        style="margin: 10px;display:inline-block;">Add Person
                                    </button>
                                    <button *ngIf="!newUser" nz-button nzSize="small" nzShape="round"
                                        (click)="handleUpdateUser()" nzType="primary"
                                        style="margin: 10px;display:inline-block;">Update User
                                    </button>
                                </div>
                            </div>
                        </div>
                    </nz-drawer>
                </div>
            </div>
        </div>
        <nz-modal [(nzVisible)]="showNewUserModal" nzTitle="Team Member Registration" (nzOnCancel)="handleCancel()"
            (nzOnOk)="handleAddUser()">
            <div style="padding:20px;color:black;">
                <p style="font-size:16px;">
                    An email will be sent to the team member being registered in order for them to complete the
                    registration
                    process.
                </p>

            </div>
            <div style="z-index: 1000;background-color: white;">
                <input nz-input nzSize="small" type="text" placeholder="First Name" ngDefaultControl
                    [(ngModel)]="newTeamMember.firstName" style="margin-bottom:10px;">
                <input nz-input nzSize="small" type="text" placeholder="Last Name" ngDefaultControl
                    [(ngModel)]="newTeamMember.lastName" style="margin-bottom:10px;">
                <input nz-input nzSize="small" type="text" placeholder="Email" ngDefaultControl
                    [(ngModel)]="newTeamMember.email" style="margin-bottom:20px;">
                <input nz-input nzSize="small" type="text" placeholder="Job Title" ngDefaultControl
                    [(ngModel)]="newTeamMember.jobTitle" style="display:inline-block;margin-bottom:20px;"
                    (input)="onInput($event.target?.value)" [nzAutocomplete]="auto">
                <nz-autocomplete nzBackfill #auto>
                    <nz-auto-option *ngFor="let option of options" [nzValue]="option">
                        {{ option }}
                    </nz-auto-option>
                </nz-autocomplete>
                <span style="margin-right:20px;float:left;">User Type</span>
                <nz-radio-group ngDefaultControl [(ngModel)]="newTeamMember.userType" style="margin-bottom:20px;">
                    <label nz-radio nzValue="individualContributor" (click)="newSupervisorSelected(false)"
                        style="display:block;font-size:28px;">
                        <i class="fad fa-user" style="vertical-align: bottom;"></i>
                        <span style="margin-left:10px;font-size:14px;">Individual Contributor</span>
                    </label>
                    <label nz-radio nzValue="supervisor" (click)="newSupervisorSelected(true)"
                        style="display:block;font-size:28px;">
                        <i class="fad fa-user-tie" style="vertical-align: bottom;"></i>
                        <span style="margin-left:10px;font-size:14px;">Supervisor</span>

                    </label>
                    <label nz-radio nzValue="volunteer" (click)="newSupervisorSelected(false)"
                        style="display:block;font-size:28px;">
                        <i class="fad fa-user-cowboy" style="vertical-align: bottom;"></i>
                        <span style="margin-left:10px;font-size:14px;">Volunteer</span>

                    </label>
                    <label nz-radio nzValue="customer" (click)="newSupervisorSelected(false)"
                        style="display:block;font-size:28px;">
                        <i class="fad fa-user-crown" style="vertical-align: bottom;"></i>
                        <span style="margin-left:10px;  font-size:14px;">Customer</span>

                    </label>
                </nz-radio-group>
            </div>
            <div [@supervisorSignupToggle]="isNewSupervisorPanelOpen ? 'open' : 'closed'"
                style="z-index: -1;height:50px;overflow: hidden;padding-left:30px;">
                <label nz-checkbox ngDefaultControl [(ngModel)]="includeNewSupervisorsTeam">Have this supervisor
                    register their team</label>
            </div>
            <label nz-checkbox ngDefaultControl [(ngModel)]="newTeamMember.teamAdmin" nz-tooltip
                nzTooltipTitle="Give this person the ability to create, update, delete trainings.">Training Admin
                Access</label>
        </nz-modal>
    </div>
</div>