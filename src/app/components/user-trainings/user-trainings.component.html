<div *ngIf="!selectedTraining" style="width:100%;height:fit-content;font-size:12px;">
    <nz-table *ngIf="userTrainings?.length > 0" nzSize="small" nzBordered="false" nzShowPagination="false" [nzData]="userTrainings"
        style="width:100%;background-color: #fafafa;font-size:12px;display:inline-block;">
        <thead>
            <tr style="font-size:12px;">
                <th>Status</th>
                <th style="padding-left:40px;">Title</th>
                <th style="padding-left:10px;">Time (mm:ss)</th>
                <th style="padding-left:10px;">Due Date</th>
                <th style="padding-left:10px;">Date Completed</th>
                <th style="padding-left:30px;">Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let userTraining of userTrainings" 
                style="cursor: pointer;font-size:12px;background-color: white;line-height:10px;">
                <td style="font-size:12px;width:7%;" nz-tooltip
                    [nzTooltipTitle]="statusIconHash[userTraining.status].desc">
                    <i nz-icon [nzType]="statusIconHash[userTraining.status].icon" [nzTheme]="'twotone'"
                        [nzTwotoneColor]="statusIconHash[userTraining.status].color" style="font-size:18px;"></i>
                </td>
                <td style="font-size:12px;width:35%;">
                    <i *ngIf="trainingIdHash[userTraining.tid].status === 'unlocked' && production === 'off'" nz-icon nzType="unlock"
                        [nzTheme]="'twotone'"
                        style="margin-right:5px;display:inline-block;font-size:12px;vertical-align: middle;"
                        [nzTwotoneColor]="'#52c41a'"></i>
                    <i *ngIf="trainingIdHash[userTraining.tid].status === 'locked' && production === 'off'" nz-icon nzType="lock"
                        [nzTheme]="'twotone'"
                        style="margin-right:5px;display:inline-block;font-size:12px;vertical-align: middle;"
                        [nzTwotoneColor]="'red'"></i>
                    <i [ngClass]="(trainingIdHash$ | async)[userTraining.tid].iconClass"
                        style="font-size:22px;margin-right:10px;vertical-align: middle;"
                        [ngStyle]="{'color': trainingIdHash[userTraining.tid].iconColor}">
                    </i>
                    {{ trainingIdHash[userTraining.tid].title }}
                </td>
                <td style="font-size:12px;width:9%;">
                    {{ timeFormat(userTraining.timeToDate) }}
                </td>
                <td *ngIf="mode === 'admin'" style="font-size:12px;width:15%;">
                    <nz-date-picker nzFormat="MM-dd-yyyy" nzSize="small" ngDefaultControl
                        [ngModel]="userTraining.dueDate" (ngModelChange)="updateDueDate($event, userTraining)">
                    </nz-date-picker>
                </td>
                <td *ngIf="mode !== 'admin'" style="font-size:12px;width:15%;">
                    {{ userTraining.dueDate | date:'mediumDate'}}
                </td>
                <td *ngIf="userTraining.dateCompleted > 0" style="font-size:12px;width:15%;">
                    {{ userTraining.dateCompleted | date:'mediumDate'}}
                </td>
                <td *ngIf="userTraining.dateCompleted === 0" style="font-size:12px;width:15%;">
                    &nbsp;&nbsp;
                </td>
                <td style="font-size:12px;width:13%;">
                    <div class="action" (click)="viewTraining(userTraining._id, userTraining.tid)" nz-tooltip
                        nzTooltipTitle="Play Training">
                        <i nz-icon [nzType]="'play-circle'" [nzTheme]="'twotone'" [nzTwotoneColor]="'#52c41a'"
                            style="font-size:18px;"></i>
                    </div>
                    <div *ngIf="!trainingIdHash[userTraining.tid].useAssessment && userTraining.status !== 'completed'"
                        class="action" (click)="markAsComplete(userTraining._id)" nz-tooltip
                        nzTooltipTitle="Mark as Complete">
                        <i nz-icon [nzType]="'check-circle'" [nzTheme]="'twotone'" [nzTwotoneColor]="'#4891f7'"
                            style="font-size:18px;"></i>
                    </div>
                    <div *ngIf="mode === 'admin'" class="action" nz-popconfirm
                        nzPopconfirmTitle="Delete this assigned training?" nz-tooltip
                        nzTooltipTitle="Delete this assigned training"
                        (nzOnConfirm)="confirmDeleteUserTraining(userTraining)">
                        <i nz-icon [nzType]="'delete'" [nzTheme]="'twotone'" [nzTwotoneColor]="'red'"
                            style="font-size:18px;"></i>
                    </div>
                </td>
            </tr>
        </tbody>
    </nz-table>
    <div *ngIf="userTrainings?.length === 0" style="text-align: center;">
        <span style="font-size:22px;display:inline-block;font-weight:300;margin-top:40px;">
            No trainings have been assigned to
            <span style="font-size:28px;color:blue;">{{selectedUser.firstName}}&nbsp;{{selectedUser.lastName}}</span> yet!
        </span>
    </div>
    <nz-modal [(nzVisible)]="markCompletedModalIsVisible" nzTitle="Mark this Training as Completed" nzWidth="800"
        (nzOnCancel)="handleMarkAsCompletedCancel()" (nzOnOk)="markTrainingAsComplete(selectedTraining)"
        style="width:800px;">
        <span style="display:block;">Rate this Training</span>
        <nz-rate style="display:block;margin-bottom:20px;" [(ngModel)]="rating" ngDefaultControl
            (ngModelChange)="ratingChanged($event)" nzAllowHalf class="small"></nz-rate>
        <span style="display:block;">Comments/Feedback</span>
        <textarea style="display:block;width:100%;" rows="4" nz-input ngDefaultControl [(ngModel)]="comment"></textarea>
    </nz-modal>
</div>
<div *ngIf="selectedTraining" style="position:relative;">
    <app-training-viewer style="width:100%;height:100%;" production="true"
        (assessmentResult)="processAssessmentResult($event)"></app-training-viewer>
</div>